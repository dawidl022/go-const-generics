\begin{figure}

    Implements
    \hfill \fbox{$\Delta \vdash \tau \imp \sigma$}
    \begin{mathpar}

        \inferrule[$\imp_{\text{Param}}$]
        { ~ }
        { \Delta \vdash \alpha \imp \alpha }

        \gray{
            \inferrule[$\imp_V$]
            { ~ }
            { \black{\Delta \vdash}~\tau_V \imp \tau_V }
        }

        \gray{
            \inferrule[$\imp_{int}$]
            {~}
            {\black{\Delta \vdash}~\kw{int} \imp \kw{int}}
        }

        \inferrule[$\imp_{const}$]
        {~}
        {\Delta \vdash \const \imp \const}

        \gray{
            \inferrule[$\imp_{n}$]
            {~}
            {\black{\Delta \vdash}~n \imp n}
        }

        \gray{
            \inferrule[$\imp_{int-n}$]
            { ~ }
            { \black{\Delta \vdash}~n \imp \kw{int} }
        }

        \gray{
            \inferrule[$\imp_I$]
            {
                \methods_\black{\Delta}(\black{\tau}) \supseteq \methods_\black{\Delta}(\black{\tau}_I) \\
            }
            { \black{\Delta \vdash}~\tau \imp \tau_I }
        }

        \inferrule[$\imp_{const-n}$]
        { n \ge 0 }
        { \Delta \vdash n \imp \const }

        \inferrule[$\imp_{const-\text{Param}}$]
        { (\alpha : \const) \in \Delta }
        { \Delta \vdash \alpha \imp \const }
    \end{mathpar}

    Well-formed type
    \hfill \fbox{$\Delta \vdash \tau \ok$}
    \begin{mathpar}
        \inferrule[t-n-type]
        { n \ge 0 }
        { \Delta \vdash n \ok }

        \gray{
            \inferrule[t-int-type]
            {~}
            { \black{\Delta \vdash}~\kw{int} \ok }
        }

        \inferrule[t-param]
        { (\alpha : \gamma) \in \Delta }
        { \Delta \vdash \alpha \ok }

        \gray{
            \inferrule[t-named]
            {
                \black{\Delta \vdash \ov{\tau \ok}}
                \and
                (\type~t\black{[\ov{\Phi}]}~T) \in \ov{D}
                \and
                \black{\eta = (\ov{\Phi \by_\Delta \tau})}
            }
            { \black{\Delta \vdash}~t\black{[\ov{\tau}]} \ok }
        }
    \end{mathpar}

    Well-formed type formals
    \hfill \fbox{$\Delta \vdash \const \ok$} \qquad \fbox{$\ov{\Phi} \ok$}
    \begin{mathpar}
        \inferrule[t-const]
        {~}
        {
            \Delta \vdash \const \ok
        }

        \inferrule[t-formal]
        {
            (\ov{\alpha~\gamma}) = \ov{\Phi} \\
            \distinct(\ov{\alpha}) \\
            \ov{\Phi} \vdash \ov{\gamma \ok}
        }
        { \ov{\Phi} \ok}

    \end{mathpar}

    Well-formed method specifications and type literals
    \hfill \fbox{$\ov{\Phi} \vdash S \ok$} \qquad \fbox{$\ov{\Phi} \vdash T \ok$}
    \begin{mathpar}
        \gray{
            \inferrule[t-specification]
            {
                \distinct(\ov{x}) \\
                \black{\ov{\Phi} \vdash \ov{\tau \ok}}\\
                \black{\ov{\Phi} \vdash \tau \ok}\\
                \black{\ov{
                        \neg \isconst_{\ov{\Phi}}(\tau)
                    }}\\
                \black{\neg \isconst_{\ov{\Phi}}(\tau)}
            }
            { \black{\ov{\Phi} \vdash}~m(\ov{x~\black{\tau}})~\black{\tau} \ok }
        }

        \gray{
            \inferrule[t-struct]
            {
                \distinct(\ov{f}) \\
                \black{\ov{\Phi} \vdash \ov{\tau \ok}}\\
                \black{
                    \ov{
                        \neg \isconst_{\ov{\Phi}}(\tau)
                    }
                }
            }
            { \black{\ov{\Phi} \vdash}~\struct~\br{\ov{f~\black{\tau}}} \ok }
        }

        \gray{
            \inferrule[t-interface]
            {
                \unique(\ov{S}) \\
                \black{\ov{\Phi} \vdash}~\ov{S \ok}
            }
            { \black{\ov{\Phi} \vdash}~\interface~\br{\ov{S}} }
        }

        \gray{
        \inferrule[t-array]
        {
        \black{\ov{\Phi} \vdash \tau_n \ok}\\
        \black{\isconst_{\ov{\Phi}}(\tau_n)}\\
        \black{\ov{\Phi} \vdash \tau \ok}\\
        \black{\neg \isconst_{\ov{\Phi}}(\tau)}
        }
        {
        \black{\ov{\Phi} \vdash}~[\black{\tau_n}]\black{\tau} \ok
        }
        }
    \end{mathpar}
    \caption{FGG typing  with arrays (1 of 3)}
\end{figure}

\begin{figure}


    Well-formed declarations \hfill \fbox{$D \ok$}
    \begin{mathpar}
        \gray{
            \inferrule[t-type]
            {
                \black{\ov{\Phi \ok}}
                \\
                \black{\ov{\Phi} = (\ov{\alpha~\gamma})}
                \\
                \black{\ov{\notref(t, \gamma)}}
                \\
                \black{\ov{\Phi} \vdash}~T \ok
            }
            { \type~t\black{[\ov{\Phi}]}~T \ok }
        }

        \gray{
            \inferrule[t-func]
            {
                \distinct(x, \ov{x}) \\
                \black{\ov{\Phi} = \typeparams(t_V)}\\
                \black{(\ov{\alpha~\gamma}) = \ov{\Phi}}\\
                \black{\ov{\Phi} \vdash}~m(\ov{x~\black{\tau}})~\black{\sigma} \ok \\
                \black{\ov{\Phi} \stoup}
                x : t_V\black{[\ov{\alpha}]} \comma \ov{x : \black{\tau}} \vdash e : \black{\tau} \\
                \black{\ov{\Phi} \vdash \tau} \imp \black{\sigma} \\
            }
            { \func~(x~t_V\black{[\ov{\alpha}]})~m(\ov{x~\black{\tau}})~\black{\sigma}~\br{\return~e} \ok }
        }

        \gray{
            \inferrule[t-func-arrayset]
            {
                \black{\sigma} = \elementtype(t_A) \\
                \black{\ov{\Phi} = \typeparams(t_A)}\\
                \black{(\ov{\alpha~\gamma}) = \ov{\Phi}} \\
                \black{\ov{\Phi} \vdash \tau} \imp \black{\sigma}
            }
            {
                \func~(x~t_A\black{[\ov{\alpha}]}) ~m(x_1~\kw{int},~x_2~\black{\tau}) ~t_A\black{[\ov{\alpha}]}~
                \br{ x[x_1] = x_2;~\return~x }
            }
        }
    \end{mathpar}
    \caption{FGG typing with arrays (2 of 3)}
\end{figure}

\begin{figure}


    Expressions \hfill \fbox{$\Delta \stoup \Gamma \vdash e : \tau$}
    \begin{mathpar}
        \inferrule[t-int-literal]
        {~}
        { \Delta;\Gamma \vdash n : n }

        \gray{
            \inferrule[t-var]
            {
                (x : \tau) \in \Gamma
            }
            { \Delta \stoup \Gamma \vdash x : \tau }
        }

        \inferrule[t-call]
        {
            (m(\ov{x~\sigma})~\sigma) \in \methods_\Delta(\tau)  \\
            \Delta \stoup \Gamma \vdash e : \tau \\
            \Delta \stoup \Gamma \vdash \ov{e : \tau} \\
            \Delta \vdash (\ov{\tau \imp \sigma})
        }
        { \Delta \stoup \Gamma \vdash e.m(\ov{e}) : \sigma }

        \inferrule[t-array-literal]
        {
        \Delta \vdash \tau_A \ok \\
        \ov{\Phi} = \typeparams(t_A)\\
        \tau_A = t_A[\ov{\sigma}] \\
        \eta = (\ov{\Phi \by \sigma})\\
        \sigma = \elementtype(t_A)[\eta] \\
        \len(\tau_A) \imp n_\tau \\
        |\ov{e}| = \len(\tau_A)\\
        \Delta ; \Gamma \vdash \ov{e : \tau} \\
        \Delta \vdash \ov{\tau <: \sigma}
        }
        { \Delta;\Gamma \vdash \tau_A\br{\ov{e}} : \tau_A }

        \inferrule[t-array-index]
        {
        \ov{\Phi} = \typeparams(t_A)\\
        \tau_A = t_A[\ov{\tau}] \\
        \eta = (\ov{\Phi \by \tau})\\
        \tau = \elementtype(t_A)[\eta]\\
        \Delta; \Gamma \vdash e_1 : \tau_A\\
        \Delta; \Gamma \vdash ~e_2 : \kw{int} \\
        }
        { \Delta;\Gamma \vdash e_1[e_2] : \tau }

        \inferrule[t-array-index-literal]
        {
        \ov{\Phi} = \typeparams(t_A)\\
        \tau_A = t_A[\ov{\tau}] \\
        \eta = (\ov{\Phi \by \tau})\\
        \tau = \elementtype(t_A)[\eta]\\
        \Delta; \Gamma \vdash e_1 : \tau_A\\
        \Delta; \Gamma \vdash ~e_2 : n \\
        \len(\tau_A) \imp n_\tau \\
        0 \le n < \len(\tau_A)
        }
        { \Delta;\Gamma \vdash e_1[e_2] : \tau }

        \gray{
            \inferrule[t-struct-literal]
            {
                \Delta \vdash \tau_S \ok
                \quad
                \Delta \stoup \Gamma \vdash \ov{e : \tau}
                \quad
                (\ov{f~\sigma}) = \fields(\tau_S)
                \quad
                \Delta \vdash \ov{\tau \imp \sigma}
            }
            { \Delta \stoup \Gamma \vdash \tau_S\br{\ov{e}} : \tau_S }
        }

        \gray{
            \inferrule[t-field]
            {
                \Delta \stoup \Gamma \vdash e : \tau_S
                \quad
                (\ov{f~\tau}) = \fields(\tau_S)
            }
            { \Delta \stoup \Gamma \vdash e.f_i : \tau_i }
        }
    \end{mathpar}

    Programs  \hfill \fbox{$P \ok$}
    \begin{mathpar}
        \gray{
            \inferrule[t-prog]
            {
                \distinct(\tdecls(\ov{D})\black{, \kw{int}}) \\
                \distinct(\mdecls(\ov{D})) \\
                \ov{D \ok} \\
                \emptyset \stoup \emptyset \vdash e : \tau
            }
            { \package~\main;~\ov{D}~\func~\main()~\br{\un=e} \ok }
        }
    \end{mathpar}

    \caption{FGG typing with arrays (3 of 3)}
\end{figure}
